machine:
  python:
    version: 2.7.12
dependencies:
  pre:
    # update locally with::
    # openssl aes-256-cbc -e -in secret-env-plain -out secret-env-cipher -k $KEY
    - openssl aes-256-cbc -d -in config-cipher -k $KEY >> configaws
compile:
  override:
     - echo 'hello world'
     - echo $ABC
     - |
        CDE=${ABC}
        echo $CDE
     - 'ls -l ~/'
     - 'aws --version'
    # - 'ls -l ~/.aws/'
deployment:
  branch: dev
  commands:
       - cat ${HOME}/${CIRCLE_PROJECT_REPONAME}/configaws
       - |
          export AWS_CONFIG_FILE=${HOME}/${CIRCLE_PROJECT_REPONAME}/configaws
          echo $AWS_CONFIG_FILE
          aws s3 sync ${HOME}/${CIRCLE_PROJECT_REPONAME}/dist s3://s3awscddev3 --cache-control private,no-store,no-cache,must-revalidate,max-age=0 --content-encoding gzip --profile devprofile
test:
  override:
     - python nosetest.py
